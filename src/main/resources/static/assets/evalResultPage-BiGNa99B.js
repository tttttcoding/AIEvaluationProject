import{d as P,v as j,P as _,T as c,x as B,g as h,r as x,h as E,E as g,b as k,y as $,F as z,e as s,t as r,i as a,k as b,w as i,l as F,o as w,_ as L}from"./index-ZCHI1N3d.js";import{u as M}from"./useScoreStore-BxaJM46H.js";import"./ToolsService-Bx7cvXeC.js";const O=l=>[{title:"基础信息评分",score:l.basic_info.basic_score,items:[{name:"目标对象",value:l.basic_info.object},{name:"分类准确性",value:l.basic_info.category},{name:"使用场景",value:l.basic_info.using},{name:"选择理由",value:l.basic_info.rationale}]},{title:"核心功能评分",score:l.core_function.core_score,items:[{name:"功能完整性",value:l.core_function.function},{name:"效果评估",value:l.core_function.effect_evaluation},{name:"改进建议",value:l.core_function.recommend}]},{title:"用户体验评分",score:l.user_experience.experience_score,items:[{name:"操作效率",value:l.user_experience.operation_efficiency},{name:"错误处理",value:l.user_experience.error_handling},{name:"文档支持",value:l.user_experience.document_support}]},{title:"实用价值评分",score:l.practical_value.practical_score,items:[{name:"成本效益",value:l.practical_value.cost_effectiveness},{name:"场景适应性",value:l.practical_value.scenario_adaptability}]},{title:"结论评分",score:l.conclusion.conclusion_score,items:[{name:"优缺点分析",value:l.conclusion.strength_weakness},{name:"应用场景",value:l.conclusion.scenario}]}].flatMap(v=>[new _({children:[new c({text:`${v.title}（${v.score}分）`,bold:!0,size:28})],spacing:{before:400,after:200}}),...v.items.map(d=>new _({children:[new c({text:`${d.name}：${d.value}分`,size:24})]}))]),A=P("fileStream",{state:()=>({}),actions:{async downloadReport(l){try{const p=new j({sections:[{properties:{},children:[new _({children:[new c({text:"AI 教学工具评价报告",bold:!0,size:32})],spacing:{after:400},alignment:"center"}),new _({children:[new c({text:`提交用户：${l.userInfo.nickname}（${l.userInfo.username}）`,size:24})]}),new _({children:[new c({text:`所属班级：${l.userInfo.className}`,size:24})]}),new _({children:[new c({text:`提交时间：${new Date(l.userInfo.submitTime*1e3).toLocaleString()}`,size:24})],spacing:{after:400}}),new _({children:[new c({text:`总分：${l.evalData.total_score}`,bold:!0,size:28})]}),new _({children:[new c({text:"总结评价：",bold:!0,size:24}),new c({text:l.evalData.summary,size:24})],spacing:{after:400}}),...O(l.evalData)]}]}),v=await B.toBlob(p),d=window.URL.createObjectURL(v),u=document.createElement("a");u.href=d,u.download=`AI教学工具评价报告_${l.userInfo.username}_${new Date().getTime()}.docx`,document.body.appendChild(u),u.click(),setTimeout(()=>{document.body.removeChild(u),window.URL.revokeObjectURL(d)},0)}catch(p){throw console.error("生成文档失败：",p),p}}}}),J={class:"eval-container"},q={class:"user-info-section"},G={class:"user-info"},H={class:"download-section"},K={class:"score-overview"},Q={class:"total-score"},W={class:"summary-card"},X={class:"score-details"},Y={class:"card-header"},Z={class:"section-score"},D={class:"score-items"},ee={class:"score-item"},se={class:"score-item"},oe={class:"score-item"},ne={class:"score-item"},le={class:"card-header"},ae={class:"section-score"},te={class:"score-items"},ie={class:"score-item"},re={class:"score-item"},ue={class:"score-item"},ce={class:"card-header"},de={class:"section-score"},me={class:"score-items"},_e={class:"score-item"},pe={class:"score-item"},ve={class:"score-item"},fe={class:"card-header"},be={class:"section-score"},Ve={class:"score-items"},we={class:"score-item"},xe={class:"score-item"},ge={class:"card-header"},ye={class:"section-score"},ke={class:"score-items"},Ue={class:"score-item"},Se={class:"score-item"},Ie=h({__name:"evalResultPage",setup(l){const p=M(),v=A(),d=x(!1),u=x(!0),f=x({nickname:"null",username:"null",className:"null"}),R=async()=>{if(!o.value){g.warning("暂无可下载的评估数据");return}d.value=!0;try{await v.downloadReport({userInfo:f.value,evalData:o.value}),g.success("下载成功")}catch(m){g.error("下载失败："+m)}finally{d.value=!1}},o=x({basic_info:{basic_score:0,object:0,category:0,using:0,rationale:0},core_function:{core_score:0,function:0,effect_evaluation:0,recommend:0},user_experience:{experience_score:0,operation_efficiency:0,error_handling:0,document_support:0},practical_value:{practical_score:0,cost_effectiveness:0,scenario_adaptability:0},conclusion:{conclusion_score:0,strength_weakness:0,scenario:0},total_score:0,summary:""});return E(async()=>{u.value=!0;try{let m=JSON.parse(localStorage.getItem("user")||"{}");f.value={nickname:m.nickname||"未知",username:m.username||"未知",className:m.cno||"未知"},await new Promise(y=>setTimeout(y,1e3));const e=p.evalData;e&&(o.value={...o.value,...e})}catch(m){g.error("数据加载失败"),console.error(m)}finally{u.value=!1}console.log("用户信息:",f.value),console.log("评估数据:",o.value)}),(m,e)=>{var U,S;const y=b("el-loading"),C=b("el-alert"),N=b("el-button"),t=b("el-rate"),V=b("el-card"),T=b("el-empty");return w(),k("div",J,[u.value?(w(),$(y,{key:0})):(w(),k(z,{key:1},[s("div",q,[s("div",G,[e[14]||(e[14]=s("h3",null,"评价报告信息",-1)),s("p",null,"提交用户："+r(f.value.nickname)+"（"+r(f.value.username)+"）",1),s("p",null,"所属班级："+r(f.value.className),1)]),s("div",H,[a(C,{title:"🚀请务必点击下载文件以持久化保存该页面信息",type:"info",closable:!1,class:"download-tip"}),a(N,{type:"primary",onClick:R},{default:i(()=>e[15]||(e[15]=[F(" 下载评价报告 ")])),_:1,__:[15]})])]),o.value?(w(),k(z,{key:0},[s("div",K,[s("div",Q,[s("h1",null,r(((U=o.value)==null?void 0:U.total_score)||0),1),e[16]||(e[16]=s("p",null,"Total Score 总分",-1))]),s("div",W,[e[17]||(e[17]=s("h3",null,"Summary 总结",-1)),s("p",null,r(((S=o.value)==null?void 0:S.summary)||"暂无总结"),1)])]),s("div",X,[a(V,{class:"score-card"},{header:i(()=>{var n,I;return[s("div",Y,[e[18]||(e[18]=s("span",null,"Basic Information 基础信息",-1)),s("span",Z,r(((I=(n=o.value)==null?void 0:n.basic_info)==null?void 0:I.basic_score)||0)+" 分",1)])]}),default:i(()=>[s("div",D,[s("div",ee,[e[19]||(e[19]=s("span",null,"目标对象",-1)),a(t,{modelValue:o.value.basic_info.object,"onUpdate:modelValue":e[0]||(e[0]=n=>o.value.basic_info.object=n),disabled:""},null,8,["modelValue"])]),s("div",se,[e[20]||(e[20]=s("span",null,"分类准确性",-1)),a(t,{modelValue:o.value.basic_info.category,"onUpdate:modelValue":e[1]||(e[1]=n=>o.value.basic_info.category=n),disabled:""},null,8,["modelValue"])]),s("div",oe,[e[21]||(e[21]=s("span",null,"使用场景",-1)),a(t,{modelValue:o.value.basic_info.using,"onUpdate:modelValue":e[2]||(e[2]=n=>o.value.basic_info.using=n),disabled:""},null,8,["modelValue"])]),s("div",ne,[e[22]||(e[22]=s("span",null,"选择理由",-1)),a(t,{modelValue:o.value.basic_info.rationale,"onUpdate:modelValue":e[3]||(e[3]=n=>o.value.basic_info.rationale=n),disabled:""},null,8,["modelValue"])])])]),_:1}),a(V,{class:"score-card"},{header:i(()=>[s("div",le,[e[23]||(e[23]=s("span",null,"Core Functions 核心功能",-1)),s("span",ae,r(o.value.core_function.core_score)+" 分",1)])]),default:i(()=>[s("div",te,[s("div",ie,[e[24]||(e[24]=s("span",null,"功能完整性",-1)),a(t,{modelValue:o.value.core_function.function,"onUpdate:modelValue":e[4]||(e[4]=n=>o.value.core_function.function=n),max:10,disabled:""},null,8,["modelValue"])]),s("div",re,[e[25]||(e[25]=s("span",null,"效果评估",-1)),a(t,{modelValue:o.value.core_function.effect_evaluation,"onUpdate:modelValue":e[5]||(e[5]=n=>o.value.core_function.effect_evaluation=n),max:10,disabled:""},null,8,["modelValue"])]),s("div",ue,[e[26]||(e[26]=s("span",null,"改进建议",-1)),a(t,{modelValue:o.value.core_function.recommend,"onUpdate:modelValue":e[6]||(e[6]=n=>o.value.core_function.recommend=n),max:10,disabled:""},null,8,["modelValue"])])])]),_:1}),a(V,{class:"score-card"},{header:i(()=>[s("div",ce,[e[27]||(e[27]=s("span",null,"User Experience 用户体验",-1)),s("span",de,r(o.value.user_experience.experience_score)+" 分",1)])]),default:i(()=>[s("div",me,[s("div",_e,[e[28]||(e[28]=s("span",null,"操作效率",-1)),a(t,{modelValue:o.value.user_experience.operation_efficiency,"onUpdate:modelValue":e[7]||(e[7]=n=>o.value.user_experience.operation_efficiency=n),max:10,disabled:""},null,8,["modelValue"])]),s("div",pe,[e[29]||(e[29]=s("span",null,"错误处理",-1)),a(t,{modelValue:o.value.user_experience.error_handling,"onUpdate:modelValue":e[8]||(e[8]=n=>o.value.user_experience.error_handling=n),max:10,disabled:""},null,8,["modelValue"])]),s("div",ve,[e[30]||(e[30]=s("span",null,"文档支持",-1)),a(t,{modelValue:o.value.user_experience.document_support,"onUpdate:modelValue":e[9]||(e[9]=n=>o.value.user_experience.document_support=n),max:10,disabled:""},null,8,["modelValue"])])])]),_:1}),a(V,{class:"score-card"},{header:i(()=>[s("div",fe,[e[31]||(e[31]=s("span",null,"Practical Value 实用价值",-1)),s("span",be,r(o.value.practical_value.practical_score)+" 分",1)])]),default:i(()=>[s("div",Ve,[s("div",we,[e[32]||(e[32]=s("span",null,"成本效益",-1)),a(t,{modelValue:o.value.practical_value.cost_effectiveness,"onUpdate:modelValue":e[10]||(e[10]=n=>o.value.practical_value.cost_effectiveness=n),max:5,disabled:""},null,8,["modelValue"])]),s("div",xe,[e[33]||(e[33]=s("span",null,"场景适应性",-1)),a(t,{modelValue:o.value.practical_value.scenario_adaptability,"onUpdate:modelValue":e[11]||(e[11]=n=>o.value.practical_value.scenario_adaptability=n),max:5,disabled:""},null,8,["modelValue"])])])]),_:1}),a(V,{class:"score-card"},{header:i(()=>[s("div",ge,[e[34]||(e[34]=s("span",null,"Conclusion 结论",-1)),s("span",ye,r(o.value.conclusion.conclusion_score)+" 分",1)])]),default:i(()=>[s("div",ke,[s("div",Ue,[e[35]||(e[35]=s("span",null,"优缺点分析",-1)),a(t,{modelValue:o.value.conclusion.strength_weakness,"onUpdate:modelValue":e[12]||(e[12]=n=>o.value.conclusion.strength_weakness=n),max:10,disabled:""},null,8,["modelValue"])]),s("div",Se,[e[36]||(e[36]=s("span",null,"应用场景",-1)),a(t,{modelValue:o.value.conclusion.scenario,"onUpdate:modelValue":e[13]||(e[13]=n=>o.value.conclusion.scenario=n),max:10,disabled:""},null,8,["modelValue"])])])]),_:1})])],64)):(w(),$(T,{key:1,description:"暂无评估数据"}))],64))])}}}),Ce=L(Ie,[["__scopeId","data-v-056e343c"]]);export{Ce as default};
