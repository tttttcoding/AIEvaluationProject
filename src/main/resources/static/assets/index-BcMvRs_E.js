import{h as S,u as B,r as k,R as T,i as E,b as $,m as R,j as e,l as r,w as o,e as u,q as a,t as f,k as n,A as F,B as q,Z as J,$ as I,a0 as O,a1 as L,a2 as j,a3 as G,a4 as W,E as A,x as Z,o as h,_ as b,a5 as H,a6 as K,a7 as Q,a8 as X,W as Y}from"./index-Bc0iVnwy.js";import{I as ee,T as oe}from"./theme-DG5HT0k6.js";const se={class:"user-info"},te={class:"username"},le={class:"dialog-footer"},ne="",ae=S({__name:"mine",setup(P){const t=B(),_=k(!1),v=k(),s=T({oldPassword:"",newPassword:"",confirmPassword:""}),m=T({oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:18,message:"密码长度必须在6-18位之间",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(i,l,g)=>{l!==s.newPassword?g(new Error("两次输入的密码不一致")):g()},trigger:"blur"}]}),w=()=>{var i;(i=v.value)==null||i.validate(async l=>{if(l)try{const g=await W(t.user.token,t.user.nickname,s.oldPassword,s.newPassword,t.user.username);t.user.token=g.Authorization,localStorage.setItem("user",JSON.stringify(t.user)),t.isFresh=0,localStorage.setItem("isFresh",JSON.stringify(t.isFresh)),A.success("密码修改成功"),_.value=!1,s.oldPassword="",s.newPassword="",s.confirmPassword=""}catch{A.error("密码修改失败,请重试")}})},C=()=>{Z.confirm("你确定退出登录吗？下次登录需重新输入用户名密码").then(()=>{t.logout(),console.log("退出登录")}).catch(i=>{console.error(i)})},x=()=>{t.changeUserNickname()};return E(()=>{const i=localStorage.getItem("user");t.user=i?JSON.parse(i):{id:0,username:"未登录",role:"未登录",token:"未登录"}}),(i,l)=>{const g=r("el-avatar"),c=r("el-icon"),p=r("el-dropdown-item"),U=r("el-dropdown-menu"),z=r("el-dropdown"),y=r("el-input"),V=r("el-form-item"),M=r("el-form"),N=r("el-button"),D=r("el-dialog");return h(),$(R,null,[e(z,{class:"user-dropdown"},{dropdown:o(()=>[e(U,null,{default:o(()=>[e(p,null,{default:o(()=>[e(c,null,{default:o(()=>[e(n(J))]),_:1}),a("UID: "+f(n(t).user.id),1)]),_:1}),e(p,null,{default:o(()=>[e(c,null,{default:o(()=>[e(n(I))]),_:1}),a("昵称："+f(n(t).user.nickname),1)]),_:1}),e(p,null,{default:o(()=>[e(c,null,{default:o(()=>[e(n(I))]),_:1}),a("账号："+f(n(t).user.username),1)]),_:1}),n(t).user.cno?(h(),F(p,{key:0},{default:o(()=>[e(c,null,{default:o(()=>[e(n(I))]),_:1}),a("班级："+f(n(t).user.cno),1)]),_:1})):q("",!0),e(p,null,{default:o(()=>[e(c,null,{default:o(()=>[e(n(O))]),_:1}),a(" 身份:   "+f(n(t).currentRoleCN),1)]),_:1}),e(p,{onClick:x},{default:o(()=>[e(c,null,{default:o(()=>[e(n(L))]),_:1}),l[6]||(l[6]=a("修改昵称 "))]),_:1,__:[6]}),e(p,{onClick:l[0]||(l[0]=d=>_.value=!0)},{default:o(()=>[e(c,null,{default:o(()=>[e(n(j))]),_:1}),l[7]||(l[7]=a("修改密码 "))]),_:1,__:[7]}),e(p,{onClick:C,divided:""},{default:o(()=>[e(c,null,{default:o(()=>[e(n(G))]),_:1}),l[8]||(l[8]=a("退出登录 "))]),_:1,__:[8]})]),_:1})]),default:o(()=>[u("div",se,[e(g,{size:32,src:ne},{default:o(()=>{var d;return[a(f((d=n(t).user.nickname)==null?void 0:d.charAt(0)),1)]}),_:1}),u("span",te,f(n(t).user.nickname),1)])]),_:1}),e(D,{modelValue:_.value,"onUpdate:modelValue":l[5]||(l[5]=d=>_.value=d),title:"修改密码",width:"400px",center:"","destroy-on-close":"","append-to-body":"","modal-append-to-body":!0,class:"password-dialog"},{footer:o(()=>[u("span",le,[e(N,{onClick:l[4]||(l[4]=d=>_.value=!1)},{default:o(()=>l[9]||(l[9]=[a("取消")])),_:1,__:[9]}),e(N,{type:"primary",onClick:w},{default:o(()=>l[10]||(l[10]=[a("确认")])),_:1,__:[10]})])]),default:o(()=>[e(M,{model:s,rules:m,ref_key:"passwordFormRef",ref:v,"label-width":"100px","status-icon":""},{default:o(()=>[e(V,{label:"旧密码",prop:"oldPassword"},{default:o(()=>[e(y,{modelValue:s.oldPassword,"onUpdate:modelValue":l[1]||(l[1]=d=>s.oldPassword=d),type:"password","show-password":"",placeholder:"请输入旧密码"},null,8,["modelValue"])]),_:1}),e(V,{label:"新密码",prop:"newPassword"},{default:o(()=>[e(y,{modelValue:s.newPassword,"onUpdate:modelValue":l[2]||(l[2]=d=>s.newPassword=d),type:"password","show-password":"",placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),e(V,{label:"确认密码",prop:"confirmPassword"},{default:o(()=>[e(y,{modelValue:s.confirmPassword,"onUpdate:modelValue":l[3]||(l[3]=d=>s.confirmPassword=d),type:"password","show-password":"",placeholder:"请确认新密码"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}}),re=b(ae,[["__scopeId","data-v-f7e57cb6"]]),de={class:"user-info"},ue=" 贡献工具",ie=" 联系我们",_e=S({__name:"illustrate",setup(P){const t=B(),_=()=>{console.log("handleInstructions")};return(v,s)=>{const m=r("el-icon"),w=r("el-dropdown-item"),C=r("el-dropdown-menu"),x=r("el-dropdown");return h(),F(x,{class:"user-dropdown"},{dropdown:o(()=>[e(C,null,{default:o(()=>[e(w,{onClick:_},{default:o(()=>[e(m,null,{default:o(()=>[e(n(K))]),_:1}),s[3]||(s[3]=a("使用说明 "))]),_:1,__:[3]}),e(w,{onClick:s[0]||(s[0]=i=>n(t).open(()=>ue))},{default:o(()=>[e(m,null,{default:o(()=>[e(n(Q))]),_:1}),s[4]||(s[4]=a("贡献工具 "))]),_:1,__:[4]}),e(w,{onClick:s[1]||(s[1]=i=>n(t).open(()=>ie))},{default:o(()=>[e(m,null,{default:o(()=>[e(n(X))]),_:1}),s[5]||(s[5]=a("联系我们 "))]),_:1,__:[5]})]),_:1})]),default:o(()=>[u("div",de,[s[2]||(s[2]=u("span",{class:"help-content"},"使用帮助",-1)),e(m,{class:"el-icon--right"},{default:o(()=>[e(n(H))]),_:1})])]),_:1})}}}),ce=b(_e,[["__scopeId","data-v-922d9591"]]),pe={},me={class:"github-content"};function fe(P,t){return h(),$("div",me,t[0]||(t[0]=[u("a",{href:"https://github.com/AlightSoulmate/vue-ai-teach",target:"_blank",class:"github-link",title:"front end"},[u("svg",{width:"22",height:"22",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},[u("path",{d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.58.82-2.14-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82a7.52 7.52 0 012.01-.27c.68.003 1.37.09 2.01.27 1.52-1.03 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.14 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"})])],-1)]))}const we=b(pe,[["render",fe],["__scopeId","data-v-682818db"]]),ge={class:"nav"},ve={class:"glass-effect"},he={class:"nav-left"},ke=["src"],be={class:"nav-right"},Pe=S({__name:"index",setup(P){const t=Y(),_=k("https://a1.x914.com/alight/i/AITeach/white-zisu-logo.png"),v=k("https://a1.x914.com/alight/i/AITeach/black-zisu-logo.png"),s=()=>{window.open("https://www.zisu.edu.cn/","_blank")};return(m,w)=>(h(),$("div",ge,[u("div",ve,[u("div",he,[e(ee),u("img",{src:n(t).isDarkTheme?v.value:_.value,alt:"logo",class:"logo",onClick:s},null,8,ke)]),u("div",be,[e(ce),e(we),e(oe),e(re)])])]))}}),ye=b(Pe,[["__scopeId","data-v-e985b406"]]);export{ye as T};
