import{g as b,r as g,c as V,b as e,f as r,e as l,l as E,o as x,_ as y,v as M,N as C,i as z,F as B,w as s,a as c,m as i,t as w,T as R,U as q,V as J,W as O,X as G,Y as L,S as W,n as N,E as X,Z as Y}from"./index-D8PVboq4.js";import{I as Z,T as j,a as H,G as K}from"./github-CMIfxXgp.js";const Q={class:"search-container"},ee=b({__name:"search",setup(S){const a=g(""),d=()=>{console.log("click search")};return(f,t)=>{const h=r("el-input");return x(),V("div",Q,[e(h,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=v=>a.value=v),placeholder:"搜索...",class:"search-input","prefix-icon":l(E),onClick:d},null,8,["modelValue","prefix-icon"])])}}}),oe=y(ee,[["__scopeId","data-v-34bdc127"]]),se={class:"user-info"},ae={class:"username"},te={class:"dialog-footer"},le="",ne=b({__name:"mine",setup(S){const a=M(),d=g(!1),f=g(),t=C({oldPassword:"",newPassword:"",confirmPassword:""}),h=C({oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:18,message:"密码长度必须在6-18位之间",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(u,o,_)=>{o!==t.newPassword?_(new Error("两次输入的密码不一致")):_()},trigger:"blur"}]}),v=()=>{var u;(u=f.value)==null||u.validate(async o=>{if(o)try{const _=await W(a.user.token,a.user.nickname,t.oldPassword,t.newPassword,a.user.username);a.user.token=_.Authorization,localStorage.setItem("user",JSON.stringify(a.user)),a.isFresh=0,localStorage.setItem("isFresh",JSON.stringify(a.isFresh)),N.success("密码修改成功"),d.value=!1,t.oldPassword="",t.newPassword="",t.confirmPassword=""}catch{N.error("密码修改失败,请重试")}})},T=()=>{X.confirm("你确定退出登录吗？下次登录需重新输入用户名密码").then(()=>{a.logout(),console.log("退出登录")}).catch(u=>{console.error(u)})},F=()=>{a.changeUserNickname()};return z(()=>{const u=localStorage.getItem("user");a.user=u?JSON.parse(u):{id:0,username:"未登录",role:"未登录",token:"未登录"}}),(u,o)=>{const _=r("el-avatar"),p=r("el-icon"),m=r("el-dropdown-item"),$=r("el-dropdown-menu"),U=r("el-dropdown"),k=r("el-input"),P=r("el-form-item"),A=r("el-form"),I=r("el-button"),D=r("el-dialog");return x(),V(B,null,[e(U,{class:"user-dropdown"},{dropdown:s(()=>[e($,null,{default:s(()=>[e(m,null,{default:s(()=>[e(p,null,{default:s(()=>[e(l(R))]),_:1}),i("ID: "+w(l(a).user.id),1)]),_:1}),e(m,null,{default:s(()=>[e(p,null,{default:s(()=>[e(l(q))]),_:1}),i("账号："+w(l(a).user.username),1)]),_:1}),e(m,null,{default:s(()=>[e(p,null,{default:s(()=>[e(l(J))]),_:1}),i(" 身份: "+w(l(a).currentRoleCN),1)]),_:1}),e(m,{onClick:F},{default:s(()=>[e(p,null,{default:s(()=>[e(l(O))]),_:1}),o[6]||(o[6]=i("修改昵称 "))]),_:1}),e(m,{onClick:o[0]||(o[0]=n=>d.value=!0)},{default:s(()=>[e(p,null,{default:s(()=>[e(l(G))]),_:1}),o[7]||(o[7]=i("修改密码 "))]),_:1}),e(m,{onClick:T,divided:""},{default:s(()=>[e(p,null,{default:s(()=>[e(l(L))]),_:1}),o[8]||(o[8]=i("退出登录 "))]),_:1})]),_:1})]),default:s(()=>[c("div",se,[e(_,{size:32,src:le},{default:s(()=>{var n;return[i(w((n=l(a).user.nickname)==null?void 0:n.charAt(0)),1)]}),_:1}),c("span",ae,w(l(a).user.nickname),1)])]),_:1}),e(D,{modelValue:d.value,"onUpdate:modelValue":o[5]||(o[5]=n=>d.value=n),title:"修改密码",width:"400px",center:"","destroy-on-close":"","append-to-body":"","modal-append-to-body":!0,class:"password-dialog"},{footer:s(()=>[c("span",te,[e(I,{onClick:o[4]||(o[4]=n=>d.value=!1)},{default:s(()=>o[9]||(o[9]=[i("取消")])),_:1}),e(I,{type:"primary",onClick:v},{default:s(()=>o[10]||(o[10]=[i("确认")])),_:1})])]),default:s(()=>[e(A,{model:t,rules:h,ref_key:"passwordFormRef",ref:f,"label-width":"100px","status-icon":""},{default:s(()=>[e(P,{label:"旧密码",prop:"oldPassword"},{default:s(()=>[e(k,{modelValue:t.oldPassword,"onUpdate:modelValue":o[1]||(o[1]=n=>t.oldPassword=n),type:"password","show-password":"",placeholder:"请输入旧密码"},null,8,["modelValue"])]),_:1}),e(P,{label:"新密码",prop:"newPassword"},{default:s(()=>[e(k,{modelValue:t.newPassword,"onUpdate:modelValue":o[2]||(o[2]=n=>t.newPassword=n),type:"password","show-password":"",placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),e(P,{label:"确认密码",prop:"confirmPassword"},{default:s(()=>[e(k,{modelValue:t.confirmPassword,"onUpdate:modelValue":o[3]||(o[3]=n=>t.confirmPassword=n),type:"password","show-password":"",placeholder:"请确认新密码"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}}),re=y(ne,[["__scopeId","data-v-d365ac4a"]]),de={class:"nav"},ue={class:"glass-effect"},ie={class:"nav-left"},ce=["src"],_e={class:"nav-right"},pe=b({__name:"index",setup(S){const a=Y(),d=g("https://a1.x914.com/alight/i/AITeach/white-zisu-logo.png"),f=g("https://a1.x914.com/alight/i/AITeach/black-zisu-logo.png");return(t,h)=>(x(),V("div",de,[c("div",ue,[c("div",ie,[e(Z),c("img",{src:l(a).isDarkTheme?f.value:d.value,alt:"logo",class:"logo"},null,8,ce),e(oe)]),c("div",_e,[e(j),e(H),e(K),e(re)])])]))}}),we=y(pe,[["__scopeId","data-v-be640403"]]);export{we as T};
