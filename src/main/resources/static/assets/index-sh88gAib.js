import{e as E,r as p,f as K,a4 as ce,c as _,o as u,y as Q,b as e,a5 as j,_ as R,q as ue,P as Pe,i as w,A as Ie,g as n,h as i,j as v,a6 as Ve,u as Fe,M as re,B as D,a7 as Ae,w as Oe,a8 as Me,E as J,a9 as Ne,C as q,F as $,T as Le,t as c,k as Ee,O,z as Y,l as G,N as Re,aa as ie,n as ze,ab as He,U as Ue,a3 as je}from"./index-Bn9PkK3f.js";import{u as De}from"./useToolsStore-CqJtWarQ.js";import{u as Je}from"./useSelectedToolStore-CjTmXgEA.js";import"./ToolsService-DFiPCrKj.js";const qe={class:"card-header"},Ye={class:"card-body"},Ge={class:"card-footer"},Ke=E({__name:"Card",setup(z){const b=p(!1),t=p(null),C=new IntersectionObserver(d=>{d.forEach(T=>{T.isIntersecting&&(b.value=!0,C.unobserve(T.target))})},{threshold:.05,rootMargin:"100px"});return K(()=>{t.value&&C.observe(t.value)}),ce(()=>{C.disconnect()}),(d,T)=>(u(),_("div",{class:Q(["card",{"is-visible":b.value}]),ref_key:"cardRef",ref:t},[e("div",qe,[j(d.$slots,"header",{},void 0,!0)]),e("div",Ye,[j(d.$slots,"default",{},void 0,!0)]),e("div",Ge,[j(d.$slots,"info",{},void 0,!0)])],2))}}),Qe=R(Ke,[["__scopeId","data-v-0b1e5890"]]),We={class:"back-top-container"},Xe=E({__name:"backTop",setup(z){const b=p(!1),t=()=>{b.value=window.scrollY>window.innerHeight*.9},C=()=>{window.scrollTo({top:0,behavior:"smooth"})};return K(()=>{window.addEventListener("scroll",t),t()}),ce(()=>{window.removeEventListener("scroll",t)}),(d,T)=>ue((u(),_("div",We,[e("button",{onClick:C},T[0]||(T[0]=[e("div",{class:"text"},[e("span",null,"Back"),e("span",null,"to"),e("span",null,"top")],-1),e("div",{class:"clone"},[e("span",null,"Back"),e("span",null,"to"),e("span",null,"top")],-1),e("svg",{"stroke-width":"2",stroke:"currentColor",viewBox:"0 0 24 24",fill:"none",class:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",width:"20px"},[e("path",{d:"M14 5l7 7m0 0l-7 7m7-7H3","stroke-linejoin":"round","stroke-linecap":"round"})],-1)]))],512)),[[Pe,b.value]])}}),Ze=R(Xe,[["__scopeId","data-v-10a9f7dc"]]),es={class:"footer"},ss={class:"footer-content"},os={class:"footer-logo"},ts={class:"footer-logo-icon"},ls=E({__name:"Foot",setup(z){return(b,t)=>{const C=w("el-icon");return u(),_("div",es,[e("div",ss,[e("div",os,[e("div",ts,[n(C,{size:24,color:"var(--el-color-primary)"},{default:i(()=>[n(v(Ve))]),_:1})]),t[0]||(t[0]=e("div",{class:"footer-logo-text"},"AI工具集",-1))]),t[1]||(t[1]=Ie('<div class="footer-links" data-v-f2f2c2cd><a href="#" class="footer-link" data-v-f2f2c2cd>关于我们</a><a href="#" class="footer-link" data-v-f2f2c2cd>联系方式</a><a href="#" class="footer-link" data-v-f2f2c2cd>隐私政策</a><a href="#" class="footer-link" data-v-f2f2c2cd>使用条款</a></div><div class="footer-copyright" data-v-f2f2c2cd>© 2025 AITEACH. 保留所有权利</div>',2))])])}}}),as=R(ls,[["__scopeId","data-v-f2f2c2cd"]]),ns={class:"hero-section"},rs={class:"hero-content"},is={class:"hero-title"},ds={class:"hero-search"},cs={class:"search-result-item"},us={class:"search-result-logo-container"},vs=["src","alt"],fs={class:"search-result-info"},ps={class:"search-result-name"},_s={class:"search-result-category"},hs={class:"search-result-score"},gs={class:"result-score"},ms={class:"hero-stats"},ws={class:"stat-item"},Cs={class:"stat-content"},ks={class:"stat-count"},ys={class:"stat-item"},bs={class:"stat-content"},xs={class:"stat-count"},Ts={class:Q(["category-navbar","mode-grid"]),id:"category-navbar"},Ss={class:"category-nav-content grid"},$s=["onClick"],Bs=["id"],Ps={class:"category-title"},Is={class:"category-count"},Vs={key:0,class:"loading-category"},Fs={class:"loading-spinner"},As={class:"spinner-progress"},Os={class:"loading-text"},Ms={class:"loading-details"},Ns={class:"loading-progress"},Ls={class:"progress-bar"},Es={key:1,class:"tools-grid"},Rs={class:"tool-logo"},zs=["src","alt","title"],Hs={class:"tool-name"},Us={class:"tool-desc"},js={class:"tool-info"},Ds={class:"rating"},Js={class:"rating-score"},qs={class:"rating-count"},Ys=["onClick"],Gs={key:1,class:"skeleton-container"},Ks={class:"skeleton-cards"},Qs={class:"backTop"},Ws={class:"dialog-footer"},de=8,Xs=E({__name:"index",setup(z){const b=Le(),t=De(),C=Je(),d=p("AI对话工具"),T=p("AI / LLM 模型工具集"),W=p(!0),M=p(!0),x=Fe(),N=p(""),X=p(!1),Z=p(null),ve=o=>s=>s.name.toLowerCase().indexOf(o.toLowerCase())!==-1||s.description.toLowerCase().indexOf(o.toLowerCase())!==-1||s.category.toLowerCase().indexOf(o.toLowerCase())!==-1,fe=((o,s)=>{let l;return(...r)=>{clearTimeout(l),l=setTimeout(()=>o(...r),s)}})((o,s)=>{const l=Object.values(t.toolsByCategory||{}).flat(),r=o?l.filter(ve(o)):[];s(r.map(h=>({value:h.name,...h})))},300),pe=o=>{Z.value=o,N.value=o.name,X.value=!1,C.selectTool(o),b.push("/detail")},_e=()=>{N.value="",Z.value=null,X.value=!1},he=o=>{C.selectTool(o),b.push("/detail")},H=p([]),S=p([]),ge=o=>{d.value=o,localStorage.setItem("activeName",JSON.stringify(o));const s=[...S.value],l=s.indexOf(o);l>0&&(s.splice(l,1),s.unshift(o),S.value=s,t.loadedCategories.has(o)||te(o))},I=p(!1),ee=p(),f=re({nickname:"",oldPassword:"",newPassword:"",confirmPassword:""}),me=re({oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:18,message:"密码长度必须在6-18位之间",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(o,s,l)=>{s!==f.newPassword?l(new Error("两次输入的密码不一致")):l()},trigger:"blur"}]}),we=()=>{var o;(o=ee.value)==null||o.validate(async s=>{if(s)try{const l=await je(x.user.token,f.nickname,f.oldPassword,f.newPassword,x.user.username);x.user.token=l.Authorization,x.user.nickname=f.nickname,localStorage.setItem("user",JSON.stringify(x.user)),x.isFresh=0,localStorage.setItem("isFresh",JSON.stringify(x.isFresh)),J.success("修改成功"),I.value=!1,f.oldPassword="",f.newPassword="",f.confirmPassword="",f.nickname=""}catch{J.error("修改失败,请重试")}})};K(async()=>{x.checkAuth(),x.isFresh==1&&(I.value=!0),M.value=!0,W.value=!0,await t.fetchCategory();const o=localStorage.getItem("activeName");if(d.value=o?JSON.parse(o):"AI对话工具",H.value=[...t.categories],S.value=[...t.categories],M.value=!1,t.categories.includes(d.value)&&await te(d.value),Ce.value.forEach(s=>{U(s)}),W.value=!1,g.value&&(g.value.addEventListener("scroll",oe),g.value.setAttribute("data-scroll-listener","true")),t.categories.includes(d.value)){const s=[...S.value],l=s.indexOf(d.value);l>0&&(s.splice(l,1),s.unshift(d.value),S.value=s)}});const Ce=D(()=>t.categories.filter(o=>t.loadedCategories.has(o))),g=p(null),se=p({}),L=o=>o.map(s=>`${s.id}-${s.ratingCount||0}`).join("|"),U=o=>{var r;if(!t.toolsByCategory[o])return;const s=t.toolsByCategory[o];if(!s||s.length===0)return;if(((r=k.value[o])==null?void 0:r.length)>0){const h=L(k.value[o]),m=L(s);if(h===m){console.log(`[${o}] 数据未变化，跳过渲染`);return}console.log(`[${o}] 数据已变化，重新渲染`)}const l=s.slice(0,de);k.value={...k.value,[o]:l},se.value[o]=[...l]},ke=o=>{const s=t.toolsByCategory[o]||[],l=k.value[o]||[];if(l.length<s.length){const r=l.length,h=Math.min(l.length+de,s.length),m=s.slice(r,h);k.value={...k.value,[o]:[...l,...m]},se.value[o]=[...k.value[o]],console.log(`[${o}] 加载更多: ${r} -> ${h}`)}},oe=()=>{if(!g.value)return;const{scrollTop:o,clientHeight:s,scrollHeight:l}=g.value;ye()},ye=o=>{var h;if(!g.value)return;const s=document.querySelectorAll(".category-section"),l=150,r=g.value.getBoundingClientRect().top;for(let m=0;m<s.length;m++){const V=s[m],B=V.getBoundingClientRect().top-r,F=B+V.offsetHeight;if(B<=l&&F>l){const P=(h=V.querySelector(".category-header"))==null?void 0:h.id;P&&P!==d.value&&(d.value=P,localStorage.setItem("activeName",JSON.stringify(P)));return}}};Oe(()=>t.toolsByCategory,(o,s)=>{var l;for(const r in o)if((l=o[r])!=null&&l.length){const h=L(o[r]),m=L((s==null?void 0:s[r])||[]);h!==m?(console.log(`[${r}] 监听器检测到数据变化，重新加载`),U(r)):console.log(`[${r}] 监听器检测到数据未变化，跳过加载`)}},{deep:!0}),Me(()=>{g.value&&g.value.hasAttribute("data-scroll-listener")&&(g.value.removeEventListener("scroll",oe),g.value.removeAttribute("data-scroll-listener"))});const be=()=>{S.value=[...H.value],d.value=H.value[0]||"对话模型",localStorage.setItem("activeName",JSON.stringify(d.value))},te=async o=>{if(!t.loadedCategories.has(o))try{await t.loadToolsForCategories([o]),U(o)}catch(s){console.error(`加载 ${o} 工具失败:`,s),J.error(`加载 ${o} 工具失败，请稍后重试`)}},xe=D(()=>Object.values(t.toolsByCategory||{}).flat().length),Te=D(()=>Object.values(t.toolsByCategory||{}).length),k=Ae({});return(o,s)=>{const l=w("el-icon"),r=w("el-autocomplete"),h=w("el-main"),m=w("el-footer"),V=w("el-container"),B=w("el-input"),F=w("el-form-item"),P=w("el-form"),le=w("el-button"),Se=w("el-dialog"),$e=Ne("loading");return u(),_($,null,[ue((u(),q(V,null,{default:i(()=>[e("div",{class:"main-container",ref_key:"scrollContainer",ref:g},[e("div",ns,[s[14]||(s[14]=e("div",{class:"hero-background"},[e("div",{class:"bg-gradient"}),e("div",{class:"bg-pattern"})],-1)),e("div",rs,[e("h1",is,c(T.value),1),e("div",ds,[n(r,{modelValue:N.value,"onUpdate:modelValue":s[0]||(s[0]=a=>N.value=a),"fetch-suggestions":v(fe),placeholder:"搜索工具名称、描述或分类...",onSelect:pe,clearable:"",onClear:_e,class:"search-input","popper-class":"search-popper","trigger-on-focus":!1},{prefix:i(()=>[n(l,{class:"search-icon"},{default:i(()=>[n(v(Ee))]),_:1})]),default:i(({item:a})=>[e("div",cs,[e("div",us,[e("img",{src:a.logo_url,alt:a.name,class:"search-result-logo"},null,8,vs)]),e("div",fs,[e("div",ps,c(a.name),1),e("div",_s,c(a.category),1)]),e("div",hs,[e("span",gs,c(a.score??Math.floor(Math.random()*5)),1),s[6]||(s[6]=e("span",{class:"result-star"},"⭐",-1))])])]),_:1},8,["modelValue","fetch-suggestions"])]),e("div",ms,[e("div",ws,[s[8]||(s[8]=e("div",{class:"stat-icon"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"22",stroke:"currentColor",fill:"none"},[e("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),e("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),e("path",{d:"M9 12h6"}),e("path",{d:"M9 16h6"})])],-1)),e("div",Cs,[e("div",ks,c(xe.value),1),s[7]||(s[7]=e("div",{class:"stat-label"},"AI工具总数",-1))])]),s[11]||(s[11]=e("div",{class:"stat-divider"},null,-1)),e("div",ys,[s[10]||(s[10]=e("div",{class:"stat-icon"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24",stroke:"currentColor",fill:"none"},[e("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),e("line",{x1:"4",y1:"22",x2:"4",y2:"15"})])],-1)),e("div",bs,[e("div",xs,c(Te.value),1),s[9]||(s[9]=e("div",{class:"stat-label"},"分类数量",-1))])]),s[12]||(s[12]=e("div",{class:"stat-divider"},null,-1)),s[13]||(s[13]=e("div",{class:"stat-item"},[e("div",{class:"stat-icon"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24",stroke:"currentColor",fill:"none"},[e("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})])])],-1))])])]),n(h,{class:"main"},{default:i(()=>[M.value?(u(),_("div",Gs,[(u(),_($,null,O(2,a=>e("div",{key:a,class:"skeleton-category"},[s[20]||(s[20]=e("div",{class:"skeleton-title"},null,-1)),e("div",Ks,[(u(),_($,null,O(4,A=>e("div",{key:A,class:"skeleton-card"},s[19]||(s[19]=[e("div",{class:"skeleton-header"},null,-1),e("div",{class:"skeleton-body"},null,-1),e("div",{class:"skeleton-info"},null,-1)]))),64))])])),64))])):(u(),_($,{key:0},[e("div",Ts,[s[16]||(s[16]=e("div",{class:"navbar-header"},[e("h3",{class:"navbar-title"},"工具分类")],-1)),e("div",Ss,[(u(!0),_($,null,O(v(t).categories,a=>(u(),_("div",{key:a,class:Q(["category-nav-item",d.value===a?"active":""]),onClick:Y(A=>ge(a),["stop"])},c(a),11,$s))),128)),e("div",{class:"category-nav-item reset",onClick:Y(be,["stop"]),title:"恢复默认顺序"},[n(l,null,{default:i(()=>[n(v(Re))]),_:1}),s[15]||(s[15]=G(" 恢复默认 "))])])]),(u(!0),_($,null,O(S.value,a=>{var A,ae,ne;return u(),_("div",{key:a,class:"category-section"},[e("div",{class:"category-header",id:a},[e("h2",Ps,c(a),1),e("div",Is,c(((A=v(t).toolsByCategory[a])==null?void 0:A.length)||0)+" 个工具 ",1)],8,Bs),v(t).loadedCategories.has(a)?(u(),_("div",Es,[(u(!0),_($,null,O(k.value[a],(y,Be)=>(u(),q(Qe,{key:y.id,class:"tool-card",style:ie({"--index":Be%8}),onClick:eo=>he(y)},{header:i(()=>[e("div",Rs,[e("img",{src:y.logo_url,alt:y.name,title:y.name},null,8,zs),e("div",Hs,c(y.name),1)])]),default:i(()=>[e("p",Us,c(y.description),1)]),info:i(()=>[e("div",js,[e("div",Ds,[e("span",Js,c((y.score??0).toFixed(1))+" ⭐ ",1),e("div",qs," 已有 "+c(y.ratingCount??0)+" 人评分 ",1)])])]),_:2},1032,["style","onClick"]))),128)),((ae=k.value[a])==null?void 0:ae.length)<(((ne=v(t).toolsByCategory[a])==null?void 0:ne.length)||0)?(u(),_("div",{key:0,class:"load-more",onClick:Y(y=>ke(a),["stop"])},[s[18]||(s[18]=e("span",null,"加载更多",-1)),n(l,{class:"load-more-icon"},{default:i(()=>[(u(),q(He(v(Ue))))]),_:1})],8,Ys)):ze("",!0)])):(u(),_("div",Vs,[e("div",Fs,[s[17]||(s[17]=e("div",{class:"spinner-circle"},null,-1)),e("div",As,c(Math.round(v(t).loadedToolsCount/v(t).totalToolsCount*100))+"% ",1)]),e("div",Os,"正在加载 "+c(a)+" 分类...",1),e("div",Ms,[e("div",Ns,[e("span",null,c(v(t).loadedToolsCount),1),e("div",Ls,[e("div",{class:"progress-fill",style:ie({width:`${v(t).loadedToolsCount/v(t).totalToolsCount*100}%`})},null,4)]),e("span",null,c(v(t).totalToolsCount),1)]),e("div",null," 已加载 "+c(v(t).loadedToolsCount)+" / "+c(v(t).totalToolsCount)+" 个工具 ",1)])]))])}),128))],64))]),_:1}),n(m,null,{default:i(()=>[n(as)]),_:1})],512),e("div",Qs,[n(Ze)])]),_:1})),[[$e,M.value]]),n(Se,{modelValue:I.value,"onUpdate:modelValue":s[5]||(s[5]=a=>I.value=a),title:"首次登陆强制修改密码",width:"400px",center:"","destroy-on-close":"","append-to-body":"","modal-append-to-body":!0,class:"password-dialog","show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1},{footer:i(()=>[e("span",Ws,[n(le,{onClick:s[4]||(s[4]=a=>I.value=!1)},{default:i(()=>s[21]||(s[21]=[G("取消")])),_:1}),n(le,{type:"primary",onClick:we},{default:i(()=>s[22]||(s[22]=[G("确认")])),_:1})])]),default:i(()=>[n(P,{model:f,rules:me,ref_key:"passwordFormRef",ref:ee,"label-width":"100px","status-icon":""},{default:i(()=>[n(F,{label:"旧密码",prop:"oldPassword"},{default:i(()=>[n(B,{modelValue:f.oldPassword,"onUpdate:modelValue":s[1]||(s[1]=a=>f.oldPassword=a),type:"password","show-password":"",placeholder:"请输入旧密码"},null,8,["modelValue"])]),_:1}),n(F,{label:"新密码",prop:"newPassword"},{default:i(()=>[n(B,{modelValue:f.newPassword,"onUpdate:modelValue":s[2]||(s[2]=a=>f.newPassword=a),type:"password","show-password":"",placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),n(F,{label:"确认密码",prop:"confirmPassword"},{default:i(()=>[n(B,{modelValue:f.confirmPassword,"onUpdate:modelValue":s[3]||(s[3]=a=>f.confirmPassword=a),type:"password","show-password":"",placeholder:"请确认新密码"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}}),ao=R(Xs,[["__scopeId","data-v-7c331047"]]);export{ao as default};
