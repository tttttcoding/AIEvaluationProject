import{d as t,F as u,P as c,T as n,a as l}from"./index-uf0FIciC.js";const a=e=>[{title:"基础信息评分",score:e.basic_info.basic_score,items:[{name:"目标对象",value:e.basic_info.object},{name:"分类准确性",value:e.basic_info.category},{name:"使用场景",value:e.basic_info.using},{name:"选择理由",value:e.basic_info.rationale}]},{title:"核心功能评分",score:e.core_function.core_score,items:[{name:"功能完整性",value:e.core_function.function},{name:"效果评估",value:e.core_function.effect_evaluation},{name:"改进建议",value:e.core_function.recommend}]},{title:"用户体验评分",score:e.user_experience.experience_score,items:[{name:"操作效率",value:e.user_experience.operation_efficiency},{name:"错误处理",value:e.user_experience.error_handling},{name:"文档支持",value:e.user_experience.document_support}]},{title:"实用价值评分",score:e.practical_value.practical_score,items:[{name:"成本效益",value:e.practical_value.cost_effectiveness},{name:"场景适应性",value:e.practical_value.scenario_adaptability}]},{title:"结论评分",score:e.conclusion.conclusion_score,items:[{name:"优缺点分析",value:e.conclusion.strength_weakness},{name:"应用场景",value:e.conclusion.scenario}]}].flatMap(r=>[new c({children:[new n({text:`${r.title}（${r.score}分）`,bold:!0,size:28})],spacing:{before:400,after:200}}),...r.items.map(i=>new c({children:[new n({text:`${i.name}：${i.value}分`,size:24})]}))]),_=t("fileStream",{state:()=>({}),actions:{async downloadReport(e){try{const o=new u({sections:[{properties:{},children:[new c({children:[new n({text:"AI 教学工具评价报告",bold:!0,size:32})],spacing:{after:400},alignment:"center"}),new c({children:[new n({text:`提交用户：${e.userInfo.nickname}（${e.userInfo.username}）`,size:24})]}),new c({children:[new n({text:`所属班级：${e.userInfo.className}`,size:24})]}),new c({children:[new n({text:`总分：${e.evalData.total_score}`,bold:!0,size:28})]}),new c({children:[new n({text:"总结评价：",bold:!0,size:24}),new n({text:e.evalData.summary,size:24})],spacing:{after:400}}),...a(e.evalData)]}]}),r=await l.toBlob(o),i=window.URL.createObjectURL(r),s=document.createElement("a");s.href=i,s.download=`AI教学工具评价报告_${e.userInfo.username}_${new Date().getTime()}.docx`,document.body.appendChild(s),s.click(),setTimeout(()=>{document.body.removeChild(s),window.URL.revokeObjectURL(i)},0)}catch(o){throw console.error("生成文档失败：",o),o}}}});export{_ as u};
