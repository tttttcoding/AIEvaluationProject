import{s as f,E as e,d as g,u as d,r as h,h as b,b as p}from"./index-UgPJK38L.js";const C=async t=>{try{return(await f.get("/courses",{headers:{Authorization:t}})).data.courses}catch(r){if(r.response)switch(r.response.status){case 401:e.error("登录状态过期，请重新登录!"),localStorage.removeItem("user");break;case 403:e.error("没有权限访问");break;case 404:e.error("请求的资源不存在");break;case 500:e.error("服务器内部错误");break;default:e.error(`请求失败: ${r.message}`)}return Promise.reject(r)}},v=async(t,r,o,u)=>{try{return(await f.post("/course",{Authorization:t,name:r,description:o,cno:u})).data}catch(c){if(c.response)switch(c.response.status){case 401:e.error("登录状态过期，请重新登录!"),localStorage.removeItem("user");break;case 403:e.error("没有权限访问");break;case 404:e.error("请求的资源不存在");break;case 500:e.error("服务器内部错误");break;default:e.error(`请求失败: ${c.message}`)}return Promise.reject(c)}},w=async(t,r,o,u,c)=>{try{return(await f.put(`/course/${r}`,{Authorization:t,name:o,description:u,cno:c})).data}catch(l){if(l.response)switch(l.response.status){case 401:e.error("登录状态过期，请重新登录!"),localStorage.removeItem("user");break;case 403:e.error("没有权限访问");break;case 404:e.error("请求的资源不存在");break;case 500:e.error("服务器内部错误");break;default:e.error(`请求失败: ${l.message}`)}return Promise.reject(l)}},I=async(t,r)=>{try{return(await f.get(`/student/history/${r}`,{headers:{Authorization:t}})).data}catch(o){if(o.response)switch(o.response.status){case 401:e.error("登录状态过期，请重新登录!"),localStorage.removeItem("user");break;case 403:e.error("没有权限访问");break;case 404:e.error("请求的资源不存在");break;case 500:e.error("服务器内部错误");break;default:e.error(`请求失败: ${o.message}`)}return Promise.reject(o)}},L=g("teacherCourse",()=>{const t=d(),r=h([]),o=async()=>{const s=await b();return r.value=s,s},u=h([]),c=async()=>{const s=t.user.token||"";if(!s){e.error("Token失效，请重新登录"),localStorage.removeItem("user"),p.push("/form");return}const a=await C(s);return u.value=a,console.log("课程列表",u.value),a},l=async(s,a,n)=>{const i=t.user.token||"";if(!i){e.error("Token失效，请重新登录"),localStorage.removeItem("user"),p.push("/form");return}return await v(i,s,a,n)},y=async(s,a,n,i)=>{const m=t.user.token||"";if(!m){e.error("Token失效，请重新登录"),localStorage.removeItem("user"),p.push("/form");return}return await w(m,s,a,n,i)},k=h([]);return{fetchHistoryByClass:async s=>{const a=t.user.token||"";if(!a){e.error("Token失效，请重新登录"),localStorage.removeItem("user"),p.push("/form");return}try{const n=await I(a,s);n.message==="查询成功"&&(console.log("班级内学生的评价和报告数量",n.users),k.value=n.users)}catch{e.error("获取成功")}},classList:r,courseList:u,fetchClassList:o,fetchCourseList:c,changeCourse:y,createCourse:l,filterClassId:s=>{var i;return console.log("filterClassName",s),((i=r.value.filter(m=>m.name===s)[0])==null?void 0:i.id)||100},fetchRateHistory:async s=>{},rates:k}});export{L as u};
