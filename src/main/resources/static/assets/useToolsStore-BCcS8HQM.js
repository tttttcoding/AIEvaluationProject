import{d as f,r,c as m,E as i}from"./index-Bc0iVnwy.js";import{g as d,a as y}from"./ToolsService-CI-kn2Kv.js";const S=f("tools",()=>{const s=r([]),l=r([]),o=r(!1),a=r(""),c=r(0),n=async e=>{if(s.value.length){o.value=!0;try{const t=await d(e);t!=null&&t.tools&&(localStorage.setItem("activeName",JSON.stringify(e)),l.value=t.tools.map(g),a.value=e,c.value=t.tools.length)}catch(t){throw i.error("工具数据获取异常"),t}finally{o.value=!1}}},u=async()=>{try{o.value=!0;const e=await y();e!=null&&e.categories&&(s.value=e.categories,a.value=JSON.parse(localStorage.getItem("activeName")||'""'),a.value||(a.value=s.value[0],localStorage.setItem("activeName",JSON.stringify(a.value))),await n(a.value))}catch{i.error("数据获取异常")}finally{o.value=!1}},g=e=>({id:e.id,name:e.name,logo_url:e.logo_url,url:e.url,description:e.description,score:e.score,ratingCount:e.ratingCount,category:e.category}),v=m(()=>l.value);return{categories:s,currentTools:v,isLoading:o,loadedCategory:a,loadedToolsCount:c,currentCategoryTools:l,loadCategoryTools:n,fetchCategory:u}});export{S as u};
